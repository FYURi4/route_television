<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú–∞—Ä—à—Ä—É—Ç–Ω–æ–µ –¢–µ–ª–µ–≤–∏–¥–µ–Ω–∏–µ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: Arial, sans-serif;
            background-color: #2B2B2B;
            min-height: 100vh;
            overflow: hidden;
            color: white;
            display: flex;
        }
        
        .video-container {
            width: 950px;
            height: 550px;
            background-color: black;
        }
        
        video {
            width: 100%;
            height: 100%;
            object-fit: cover;
            outline: none;
        }
        
        .info-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            background-color: black;
            height: 550px;
            padding: 30px;
        }
        
        .time {
            font-size: 80px;
            font-weight: bold;
            margin-bottom: 5px;
            line-height: 0.9;
            color: #fff;
            margin-left: 20px;
        }
        
        .date {
            font-size: 40px;
            text-align: left;
            line-height: 1.2;
            color: #ddd;
            margin-left: 20px;
        }
      
        .date-container {
            display: flex;
            justify-content: left;
            align-items: left;
            gap: 10px;
        }
        
        .weather {
            margin-top: 15px;
            font-size: 50px;
            display: flex;
            align-items: center;
            gap: 10px;
            margin-left: 20px;
        }
        
        .weather-icon {
            font-size: 120px;
        }
        
        .weather-data {
            display: flex;
            flex-direction: column;
        }
      
        #route-number {
            position: absolute;
            top: 330px;
            left: 1050px;
            color: white;
            font-size: 30px;
            font-family: Arial, sans-serif;
            font-weight: bold;
        }
        
        .route-line {
            position: absolute;
            bottom: 50px;
            left: 0;
            width: 100%;
            height: 60px;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 0 20px;
        }
        
        .stops-container {
            display: flex;
            width: 100%;
            max-width: 1200px;
            position: relative;
            height: 10px;
            background-color: #555;
            border-radius: 5px;
        }
        
        .progress-line {
            position: absolute;
            height: 100%;
            background-color: #ffcc00;
            border-radius: 5px;
            width: 0;
            transition: width 0.5s ease;
        }
        
        .stop {
            position: absolute;
            top: -15px;
            width: 40px;
            height: 40px;
            background-color: #555;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 14px;
            font-weight: bold;
            color: white;
            transform: translateX(-50%);
            z-index: 2;
        }
        
        .stop.active {
            background-color: #ffcc00;
            color: #333;
            box-shadow: 0 0 10px #ffcc00;
        }
        
        .current-stop {
            position: absolute;
            bottom: 120px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 40px;
            color: white;
            white-space: nowrap;
        }
        
        .next-stop {
            position: absolute;
            bottom: 120px;
            right: 20px;
            font-size: 18px;
            color: #ccc;
            white-space: nowrap;
        }
      
        #route-path {
            position: absolute;
            top: 390px;
            left: 990px;
            color: white;
            font-size: 30px;
            font-family: Arial, sans-serif;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="video-container">
        <video id="videoPlayer" autoplay muted></video>
    </div>
    
    <div class="info-container">
        <div class="time" id="time">00:00</div>
        <div class="date">
            <div class="date-container" id="dateContainer">
                <div class="weekday" id="weekday">–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫</div>
                <div id="day">1</div>
                <div id="month">–Ø–Ω–≤–∞—Ä—å</div>
            </div>
        </div>
        <div class="weather">
            <div class="weather-icon" id="weather-icon">‚òÄÔ∏è</div>
            <div class="weather-data">
                <div id="weather-temp">+22¬∞</div>
                <div id="weather-wind">3 –º/—Å</div>
            </div>
        </div>
        <div id="route-number">–ú–∞—Ä—à—Ä—É—Ç ‚Ññ: 00</div>
        <div id="route-path"></div>
      
    </div>
    
    <div class="route-line">

    </div>
    
    <div class="current-stop" id="stop-name">–û—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞</div>
    
    <script>
        function updateRouteInfo(routeNum, firstStop, lastStop) {
            document.getElementById('route-number').textContent = '–ú–∞—Ä—à—Ä—É—Ç ‚Ññ: ' + routeNum;
            document.getElementById('route-path').textContent = firstStop + ' ‚Üí ' + lastStop;
        }

        function updateStopName(stopText) {
            document.getElementById('stop-name').textContent = stopText;
        }
      
      
        let currentStopIndex = 0;
        let stopChangeInterval;
        
        function updateRouteNumber(num) {
            document.getElementById('route-number').textContent = '–ú–∞—Ä—à—Ä—É—Ç ‚Ññ: ' + num;
        }
        
        
        document.addEventListener('DOMContentLoaded', function() {
            const videoPlayer = document.getElementById('videoPlayer');
            const timeElement = document.getElementById('time');
            const weekdayElement = document.getElementById('weekday');
            const dayElement = document.getElementById('day');
            const monthElement = document.getElementById('month');
            const weatherIcon = document.getElementById('weather-icon');
            const weatherTemp = document.getElementById('weather-temp');
            const weatherWind = document.getElementById('weather-wind');
            
            let allVideos = [];
            let currentVideoIndex = 0;
            let retryCount = 0;
            const maxRetries = 3;
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –∏ –¥–∞—Ç—ã
            function updateClock() {
                const now = new Date();
                
                // –í—Ä–µ–º—è
                const hours = String(now.getHours()).padStart(2, '0');
                const minutes = String(now.getMinutes()).padStart(2, '0');
                timeElement.textContent = `${hours}:${minutes}`;
                
                // –î–∞—Ç–∞
                const weekdays = ['–í—Å,', '–ü–Ω,', '–í—Ç,', '–°—Ä,', '–ß—Ç,', '–ü—Ç,', '–°–±,'];
                const months = ['—è–Ω–≤–∞—Ä—è', '—Ñ–µ–≤—Ä–∞–ª—è', '–º–∞—Ä—Ç–∞', '–∞–ø—Ä–µ–ª—è', '–º–∞—è', '–∏—é–Ω—è', '–∏—é–ª—è', '–∞–≤–≥—É—Å—Ç–∞', '—Å–µ–Ω—Ç—è–±—Ä—è', '–æ–∫—Ç—è–±—Ä—è', '–Ω–æ—è–±—Ä—è', '–¥–µ–∫–∞–±—Ä—è'];
                
                weekdayElement.textContent = weekdays[now.getDay()];
                dayElement.textContent = now.getDate();
                monthElement.textContent = months[now.getMonth()];
                
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–≥–æ–¥—ã –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤—Ä–µ–º–µ–Ω–∏ —Å—É—Ç–æ–∫
                updateWeather(now.getHours());
            }
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–≥–æ–¥—ã (—Å–∏–º–≤–æ–ª + –¥–∞–Ω–Ω—ã–µ)
            function updateWeather(hour) {
                // –ò–º–∏—Ç–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö - –≤ —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –Ω—É–∂–Ω–æ API
                const weatherData = {
                    day: {
                        icon: "‚òÄÔ∏è",
                        temp: "+22¬∞",
                        wind: "3 –º/—Å"
                    },
                    evening: {
                        icon: "‚òÅÔ∏è",
                        temp: "+18¬∞",
                        wind: "2 –º/—Å"
                    },
                    night: {
                        icon: "üåô",
                        temp: "+15¬∞",
                        wind: "1 –º/—Å"
                    }
                };
                
                let currentWeather;
                if (hour >= 6 && hour < 18) {
                    currentWeather = weatherData.day;
                } else if (hour >= 18 && hour < 23) {
                    currentWeather = weatherData.evening;
                } else {
                    currentWeather = weatherData.night;
                }
                
                weatherIcon.textContent = currentWeather.icon;
                weatherTemp.textContent = currentWeather.temp;
                weatherWind.textContent = currentWeather.wind;
            }
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ JSON —Å GitHub
            async function loadVideos() {
                try {
                    const response = await fetch('https://raw.githubusercontent.com/FYURi4/route_television/main/video-gmod/permission.json');
                    
                    if (!response.ok) {
                        throw new Error('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å JSON —Ñ–∞–π–ª');
                    }
                    
                    const data = await response.json();
                    
                    // –°–æ–±–∏—Ä–∞–µ–º –≤—Å–µ –≤–∏–¥–µ–æ –∏–∑ –≤—Å–µ—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π –≤ –æ–¥–∏–Ω –º–∞—Å—Å–∏–≤
                    for (const category in data) {
                        if (Array.isArray(data[category])) {
                            data[category].forEach(video => {
                                if (video.enabled) {
                                    allVideos.push({
                                        url: video.url.replace('github.com', 'cdn.jsdelivr.net/gh').replace('/blob/', '/'),
                                        category: category
                                    });
                                }
                            });
                        }
                    }
                    
                    if (allVideos.length > 0) {
                        playNextVideo();
                    }
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –≤–∏–¥–µ–æ:', error);
                    
                    // –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
                    if (retryCount < maxRetries) {
                        retryCount++;
                        setTimeout(loadVideos, 5000);
                    }
                }
            }
            
            // –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ —Å–ª–µ–¥—É—é—â–µ–≥–æ –≤–∏–¥–µ–æ
            function playNextVideo() {
                if (allVideos.length === 0) return;
                
                currentVideoIndex = (currentVideoIndex + 1) % allVideos.length;
                const video = allVideos[currentVideoIndex];
                
                videoPlayer.src = video.url;
                
                videoPlayer.onerror = function() {
                    console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –≤–∏–¥–µ–æ:', video.url);
                    // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –ø—Ä–æ–±–ª–µ–º–Ω–æ–µ –≤–∏–¥–µ–æ –∏ –ø–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Å–ª–µ–¥—É—é—â–µ–º—É
                    setTimeout(playNextVideo, 1000);
                };
                
                videoPlayer.onloadedmetadata = function() {
                    videoPlayer.play()
                        .catch(error => {
                            console.log('–ê–≤—Ç–æ–≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –Ω–µ —É–¥–∞–ª–æ—Å—å:', error);
                            videoPlayer.muted = true;
                            videoPlayer.play();
                        });
                };
            }
            
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–ª–µ–¥—É—é—â–µ–µ –≤–∏–¥–µ–æ –ø—Ä–∏ –æ–∫–æ–Ω—á–∞–Ω–∏–∏ —Ç–µ–∫—É—â–µ–≥–æ
            videoPlayer.addEventListener('ended', function() {
                playNextVideo();
            });
            
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è
            videoPlayer.addEventListener('error', function() {
                setTimeout(playNextVideo, 1000);
            });
            
            // –ù–∞—á–∞–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –≤–∏–¥–µ–æ
            loadVideos();
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É
            updateClock();
            setInterval(updateClock, 1000);
            
            // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∫–∞–∂–¥—ã–µ 12 —á–∞—Å–æ–≤ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞
            setTimeout(() => location.reload(), 12 * 60 * 60 * 1000);
        });
    </script>
</body>
</html>
